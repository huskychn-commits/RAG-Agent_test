(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      5864,        158]
NotebookOptionsPosition[      5367,        140]
NotebookOutlinePosition[      5783,        157]
CellTagsIndexPosition[      5740,        154]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:53c2\:6570\:5b9a\:4e49", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"Vc", "=", "0.01"}], ";", 
    RowBox[{"(*", 
     RowBox[{"\:5bb9\:5668\:4f53\:79ef", " ", 
      RowBox[{"m", "^", "3"}]}], "*)"}], 
    RowBox[{"VpM", "=", "0.001"}], ";", 
    RowBox[{"(*", 
     RowBox[{"\:6d3b\:585e\:6700\:5927\:4f53\:79ef", " ", 
      RowBox[{"m", "^", "3"}]}], "*)"}], 
    RowBox[{"Pa", "=", 
     RowBox[{"1.0", "*", 
      RowBox[{"10", "^", "5"}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"\:5927\:6c14\:538b", " ", "Pa"}], "*)"}], 
    RowBox[{
    "(*", "\:6bcf\:6b21\:6253\:6c14\:589e\:52a0\:7684\:538b\:5f3a", "*)"}], 
    RowBox[{"dP", "=", 
     RowBox[{"Pa", "*", 
      RowBox[{"VpM", "/", "Vc"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\:6253\:6c14\:6b21\:6570", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ntimes", "=", "50"}], ";"}], "\n", 
   RowBox[{"(*", "\:521d\:59cb\:5316", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pk", "=", "Pa"}], ";", 
    RowBox[{"(*", "\:521d\:59cb\:5bb9\:5668\:538b\:5f3a", "*)"}], 
    RowBox[{"totalWork", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"\:5faa\:73af\:8ba1\:7b97", " ", "N", " ", "\:6b21\:6253\:6c14"}],
     "*)"}], "\n", 
   RowBox[{"Do", "[", 
    RowBox[{"(*", "\:8bb0\:5f55\:4e0a\:4e00\:6b21\:538b\:5f3a", "*)"}], 
    RowBox[{
     RowBox[{
      RowBox[{"Pprev", "=", "Pk"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "\:4e0b\:4e00\:6b21\:538b\:5f3a", "*)"}], 
      RowBox[{"Pk", "=", 
       RowBox[{"Pprev", "+", "dP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "(*", "\:7b2c\:4e00\:9636\:6bb5\:7ed3\:675f\:65f6\:7684\:6d3b\:585e\
\:4f53\:79ef", "*)"}], 
      RowBox[{"VpStar", "=", 
       RowBox[{"VpM", "*", 
        RowBox[{"Pa", "/", "Pprev"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"\:7b2c\:4e00\:9636\:6bb5\:505a\:529f", "\:ff1a", 
        RowBox[{
        "\:538b\:7f29\:6d3b\:585e\:5185\:6c14\:4f53\:5230", " ", "Pprev"}]}], 
       "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Pprev", ">", "Pa"}], ",", 
        RowBox[{"W1", "=", 
         RowBox[{"Pa", "*", "VpM", "*", 
          RowBox[{"Log", "[", 
           RowBox[{"Pprev", "/", "Pa"}], "]"}]}]}], ",", 
        RowBox[{"W1", "=", "0.0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"\:5b9e\:9645\:4e0a", " ", "Pprev"}], ">=", "Pa"}], "\:ff0c", 
        RowBox[{
         RowBox[{"Log", "[", "1", "]"}], "=", 
         RowBox[{
          RowBox[{"0", " ", "\:5f53", " ", "k"}], "=", "1"}]}]}], "*)"}], 
      RowBox[{"W1", "=", 
       RowBox[{"Pa", "*", "VpM", "*", 
        RowBox[{"Log", "[", 
         RowBox[{"Pprev", "/", "Pa"}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"\:5141\:8bb8\:4e3a", " ", "0"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"\:7b2c\:4e8c\:9636\:6bb5\:505a\:529f", "\:ff1a", 
        RowBox[{
        "\:538b\:7f29\:6d3b\:585e", "+", "\:5bb9\:5668\:6574\:4f53"}]}], 
       "*)"}], 
      RowBox[{"Vi", "=", 
       RowBox[{"Vc", "+", "VpStar"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Vf", "=", "Vc"}], ";", "\[IndentingNewLine]", 
      RowBox[{"W2", "=", 
       RowBox[{"Pprev", "*", "Vi", "*", 
        RowBox[{"Log", "[", 
         RowBox[{"Vi", "/", "Vf"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "\:7d2f\:52a0\:505a\:529f", "*)"}], 
      RowBox[{"Wk", "=", 
       RowBox[{"W1", "+", "W2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"totalWork", "+=", "Wk"}], ";"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "Ntimes"}], "}"}]}], "]"}], "\n", 
   RowBox[{"(*", "\:8f93\:51fa\:603b\:529f", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\:6253\:6c14 \>\"", ",", "Ntimes", ",", 
     "\"\< \:6b21\:540e\:6240\:9700\:603b\:529f\:4e3a: \>\"", ",", 
     "totalWork", ",", "\"\< \:7126\:8033\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.96943438352499*^9, 3.969434392167843*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e96f770f-ede2-4838-a34a-601c8f08e48f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:6253\:6c14 \"\>", "\[InvisibleSpace]", "50", 
   "\[InvisibleSpace]", "\<\" \:6b21\:540e\:6240\:9700\:603b\:529f\:4e3a: \
\"\>", "\[InvisibleSpace]", "10750.556815368336`", 
   "\[InvisibleSpace]", "\<\" \:7126\:8033\"\>"}],
  SequenceForm[
  "\:6253\:6c14 ", 50, " \:6b21\:540e\:6240\:9700\:603b\:529f\:4e3a: ", 
   10750.556815368336`, " \:7126\:8033"],
  Editable->False]], "Print",
 CellChangeTimes->{3.9694343945168295`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"9abce9c9-ddb2-4bd9-8e5a-\
d24d487eaf6c"]
}, Open  ]]
},
WindowSize->{571., 627.5},
WindowMargins->{{349, Automatic}, {Automatic, 57}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (2021\:5e7412\:67082\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"21090f01-b239-44e8-90b6-50432d90a703"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4181, 100, 577, "Input",ExpressionUUID->"e96f770f-ede2-4838-a34a-601c8f08e48f"],
Cell[4764, 124, 587, 13, 22, "Print",ExpressionUUID->"9abce9c9-ddb2-4bd9-8e5a-d24d487eaf6c"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

