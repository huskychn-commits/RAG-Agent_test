(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12395,        318]
NotebookOptionsPosition[     11546,        294]
NotebookOutlinePosition[     11997,        312]
CellTagsIndexPosition[     11954,        309]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:53c2\:6570\:8bbe\:7f6e", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"pa", "=", "100000"}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "\:5916\:754c\:538b\:5f3a", "\:ff0c", "\:5355\:4f4d", "\:ff1a", "Pa"}], 
     "*)"}], 
    RowBox[{"vc", "=", "0.01"}], ";", 
    RowBox[{"(*", 
     RowBox[{"\:5bb9\:5668\:5bb9\:79ef", "\:ff0c", "\:5355\:4f4d", "\:ff1a", 
      RowBox[{"m", "^", "3"}]}], "*)"}], 
    RowBox[{"vp", "=", "0.001"}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "\:6d3b\:585e\:6700\:5927\:5bb9\:79ef", "\:ff0c", "\:5355\:4f4d", 
      "\:ff1a", 
      RowBox[{"m", "^", "3"}]}], "*)"}], 
    RowBox[{"r", "=", 
     RowBox[{"vp", "/", "vc"}]}], ";", 
    RowBox[{"(*", "\:6bd4\:4f8b\:7cfb\:6570", "*)"}], 
    RowBox[{"n", "=", "50"}], ";", 
    RowBox[{"(*", "\:6253\:6c14\:6b21\:6570", "*)"}], 
    RowBox[{"(*", "\:5bb9\:5668\:538b\:5f3a\:51fd\:6570", "*)"}], 
    RowBox[{
     RowBox[{"pk", "[", "0", "]"}], "=", "pa"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pk", "[", "k_", "]"}], ":=", 
     RowBox[{"pa", "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"k", "*", "r"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\:6bcf\:6b21\:6253\:6c14\:7684\:529f", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "[", "k_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pPrev", ",", "pCurr"}], "}"}], ",", 
       RowBox[{
        RowBox[{"pPrev", "=", 
         RowBox[{"pk", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pCurr", "=", 
         RowBox[{"pk", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pa", "*", "vp", "*", 
          RowBox[{"Log", "[", 
           RowBox[{"pPrev", "/", "pa"}], "]"}]}], "+", 
         RowBox[{"pCurr", "*", "vc", "*", 
          RowBox[{"Log", "[", 
           RowBox[{"pCurr", "/", "pPrev"}], "]"}]}]}]}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{"(*", "\:8ba1\:7b97\:603b\:529f", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"totalWork", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"W", "[", "k", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"N", "[", "totalWork", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.969415371481618*^9, 3.96941537148363*^9}, {
  3.9694154085560584`*^9, 3.9694154109229813`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"106a63eb-97e2-42a0-bee3-f028fb252f56"],

Cell[BoxData["10750.556815368327`"], "Output",
 CellChangeTimes->{{3.969415397065817*^9, 3.9694154142518005`*^9}},
 CellLabel->"Out[10]=",ExpressionUUID->"31bc725f-0a26-447b-9e31-4e8015fe0298"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "\:8ba1\:7b97\:6bcf\:6b21\:505a\:529f\:548c\:7d2f\:8ba1\:505a\:529f", 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"workData", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"W", "[", "k", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cumulativeWork", "=", 
     RowBox[{"Accumulate", "[", "workData", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:7ed8\:5236\:6bcf\:6b21\:505a\:529f\:968f\:6b21\:6570\:7684\:53d8\
\:5316\:56fe", "*)"}], "\n", 
   RowBox[{
    RowBox[{"plot1", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"workData", ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"PointSize", "[", "Medium", "]"}]}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\:6253\:6c14\:6b21\:6570 k\>\"", ",", 
          "\"\<\:6bcf\:6b21\:505a\:529f W_k (J)\>\""}], "}"}]}], ",", 
       RowBox[{
       "PlotLabel", "->", 
        "\"\<\:6bcf\:6b21\:6253\:6c14\:505a\:529f\:968f\:6b21\:6570\:7684\
\:53d8\:5316\>\""}], ",", 
       RowBox[{"GridLines", "->", "Automatic"}], ",", 
       RowBox[{"Joined", "->", "True"}], ",", 
       RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
   "(*", "\:7ed8\:5236\:7d2f\:8ba1\:505a\:529f\:968f\:6b21\:6570\:7684\:53d8\
\:5316\:56fe", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plot2", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"cumulativeWork", ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"PointSize", "[", "Medium", "]"}]}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\:6253\:6c14\:6b21\:6570 k\>\"", ",", 
          "\"\<\:7d2f\:8ba1\:505a\:529f (J)\>\""}], "}"}]}], ",", 
       RowBox[{
       "PlotLabel", "->", 
        "\"\<\:7d2f\:8ba1\:505a\:529f\:968f\:6b21\:6570\:7684\:53d8\:5316\>\"\
"}], ",", 
       RowBox[{"GridLines", "->", "Automatic"}], ",", 
       RowBox[{"Joined", "->", "True"}], ",", 
       RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\:540c\:65f6\:663e\:793a\:4e24\:4e2a\:56fe\:8868", "*)"}], 
   "\n", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{"plot1", ",", "plot2"}], "}"}], "]"}], "\n", 
   RowBox[{"(*", "\:8ba1\:7b97\:603b\:529f", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"totalWork", "=", 
     RowBox[{"cumulativeWork", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\:603b\:529f: \>\"", ",", 
     RowBox[{"N", "[", "totalWork", "]"}], ",", "\"\< J\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9694156100996933`*^9, 3.969415627717459*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"5fb0f458-c407-434e-8fe9-d4a02c2dd673"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, {{}, {}, {
       RGBColor[0, 0, 1], 
       PointSize[Medium], 
       AbsoluteThickness[1.6], 
       LineBox[CompressedData["
1:eJw1yXtIE2AUh+FlrGbBTBO6aOliSMac5lzbmrnf5txcYtmqtSy23NzcXO0i
JRE2Bl0xtAxMFl2N6g+jEa4UrEjCbliuWWa1LIgSIapJWC02Kvy+A4fDc16O
yaW1JDEYjMJ/+/9Oz3dZ1j1p/oiwGuQBPyO4b0/TdmIWJAdy1PaTBuJ5eFbD
3HBatoM4HbsHWY0Gbg3xQqQnc7SR39SZGI6Eg/F+E3E2hvPEA5u9ZuJlqH25
TltUUEvMRVXX1+TgKHUOLvUYswb2WoiXI3AopU6YaiVegbDT7r/VSc3DnBSv
+GNeHTEfxe6YS9FNXYDcE0Z+hcBGvBK9Yedl63XqQix2Dm2c5NqJBTA1O27I
O6iL8OjY67bzzHpiIXTmixXr3dSrsIT3ItDyilqE/uMTb9qkDmIxuFe/fWo5
Qy1BM+vK/kCMejWMobg5W7eTWAq2wf9+VoC6GElPRJmHmbuI12A8w+m9u5W6
BJ97Or887aKWIR4aZ4f+UANNGXOPjGmc0/YBquhPTuopYoYclR3VM70faJfj
wbbKQUmui3QFfiR672xxE/sUsKb9Gpm4SXspYkdFUUaM9lJUNSQcuqVu0pXo
uN2enygh9inx/G19X8JAexkmG1rPGby0l0Gv583mnqVdBZYk8nhTH+0qXHuo
tE2N0q7GfAt3AXuKdjXehYfuX0jzkF4OQaNwUTef2FeO1qjnoGYt7RqM6WdI
bBYP/gJVe9P8
        "]]}}, {{}, {}}}, AspectRatio -> 
    NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
    AxesLabel -> {
      FormBox["\"\:6253\:6c14\:6b21\:6570 k\"", TraditionalForm], 
      FormBox["\"\:6bcf\:6b21\:505a\:529f W_k (J)\"", TraditionalForm]}, 
    AxesOrigin -> {0, 0}, DisplayFunction -> Identity, 
    Frame -> {{False, False}, {False, False}}, 
    FrameLabel -> {{None, None}, {None, None}}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {Automatic, Automatic}, GridLinesStyle -> Directive[
      GrayLevel[0.5, 0.4]], ImageSize -> {419.3999999999999, Automatic}, 
    Method -> {
     "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& )}}, PlotLabel -> 
    FormBox["\"\:6bcf\:6b21\:6253\:6c14\:505a\:529f\:968f\:6b21\:6570\:7684\
\:53d8\:5316\"", TraditionalForm], 
    PlotRange -> {{0, 50}, {0, 278.3379449894545}}, PlotRangeClipping -> True,
     PlotRangePadding -> {{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.02], 
       Scaled[0.05]}}, Ticks -> {Automatic, Automatic}], 
   GraphicsBox[{{}, {{}, {}, {
       RGBColor[1, 0, 0], 
       PointSize[Medium], 
       AbsoluteThickness[1.6], 
       LineBox[CompressedData["
1:eJw10GtI02EUx/GZCsVgjVi1xJpZdhmbTcvMOd1vc5tKF/LyIteIlMzc5pQw
7EL1B5ENFjRKIxlFsmEbs4vNUps6UymFmERzlUFUKyvNqCYFpXTz9MDh8Dnf
d8/qsurC8gUsFiv1z/zd8++zXNCfuSmUpgUdoHv5PZhUYiAvxKxNLRMXHCFz
EVYMH/hRc5LMA6d4YrQxqp7MR9EF0xs2YybHw7LTUWCVnCEn4FTb0VKuxUZO
hNA8MLWMc568Fo06VpXY3UReB0vRR65mz0XyBmSrAr3GODtZCP7hn7bBT5fI
Isw1x87K9VfIyYhSxK6pfdtCliBGOjXmOuQgp0CyXomzESc5FUtWnS5/0dBK
3oyuUBNTKHCRt6C22nusze8mp8HdUGVqP+ghb4VhWJ8v5F0jp6OidEVF+MF1
8jZMi3sSQ7hJzkDKPvdlT0I7WYqOHSMtuuhb5Ew4l99/Gnz/3zLMjF1dFPXI
S87CY419LuDrIGfj3L//u02WI85eN81uvkMGvkVuvNJaO+fNAIzXr2czXdQV
kFrGtYvruqkrwI/INpbU3KWuBNcnfPfc4KOuhOPE6zRrZQ/1HEylG7P2VvZS
zwFXIHLC0EddhWfHk8ySaj91FbbzTBk2aT91NcLmsuT6PjKjRuukfZcx5x51
DUwPJ2c0I2RGA89XkYuze4B6LoJLJ/j+J2QmF4bGGEHx/kHqeViJQOfIBzKT
B/fol+j42iHq+agZ71bn/hrCb/8s3Bc=
        "]]}}, {{}, {}}}, AspectRatio -> 
    NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
    AxesLabel -> {
      FormBox["\"\:6253\:6c14\:6b21\:6570 k\"", TraditionalForm], 
      FormBox["\"\:7d2f\:8ba1\:505a\:529f (J)\"", TraditionalForm]}, 
    AxesOrigin -> {0, 0}, DisplayFunction -> Identity, 
    Frame -> {{False, False}, {False, False}}, 
    FrameLabel -> {{None, None}, {None, None}}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {Automatic, Automatic}, GridLinesStyle -> Directive[
      GrayLevel[0.5, 0.4]], ImageSize -> {413.4000000000001, Automatic}, 
    Method -> {
     "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          Identity[
           Part[#, 1]], 
          Identity[
           Part[#, 2]]}& )}}, PlotLabel -> 
    FormBox["\"\:7d2f\:8ba1\:505a\:529f\:968f\:6b21\:6570\:7684\:53d8\:5316\"\
", TraditionalForm], PlotRange -> {{0, 50}, {0, 10750.556815368327`}}, 
    PlotRangeClipping -> True, PlotRangePadding -> {{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.02], 
       Scaled[0.05]}}, Ticks -> {Automatic, Automatic}]},
  "RowDefault"]], "Output",
 CellChangeTimes->{3.9694156384036403`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"3ec1b532-1e12-4cfe-8f22-359b1621212d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:603b\:529f: \"\>", "\[InvisibleSpace]", 
   "10750.556815368327`", "\[InvisibleSpace]", "\<\" J\"\>"}],
  SequenceForm["\:603b\:529f: ", 10750.556815368327`, " J"],
  Editable->False]], "Print",
 CellChangeTimes->{3.9694156384704113`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[11]:=",ExpressionUUID->"f993b9d9-0ce8-43bc-85ac-\
9c041ae99f92"]
}, Open  ]]
},
WindowSize->{1152., 615.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (2021\:5e7412\:67082\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5f6f0eaa-a86d-4d1f-b60d-a6494db3fb77"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2581, 68, 339, "Input",ExpressionUUID->"106a63eb-97e2-42a0-bee3-f028fb252f56"],
Cell[3164, 92, 193, 2, 32, "Output",ExpressionUUID->"31bc725f-0a26-447b-9e31-4e8015fe0298"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3394, 99, 3041, 80, 399, "Input",ExpressionUUID->"5fb0f458-c407-434e-8fe9-d4a02c2dd673"],
Cell[6438, 181, 4692, 99, 264, "Output",ExpressionUUID->"3ec1b532-1e12-4cfe-8f22-359b1621212d"],
Cell[11133, 282, 397, 9, 22, "Print",ExpressionUUID->"f993b9d9-0ce8-43bc-85ac-9c041ae99f92"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

